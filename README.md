## ❓ [과제] `point` 패키지의 TODO 와 테스트코드를 작성해주세요.

- PATCH  `/point/{id}/charge` : 포인트를 충전한다.
- PATCH `/point/{id}/use` : 포인트를 사용한다.
- *GET `/point/{id}` : 포인트를 조회한다.*
- *GET `/point/{id}/histories` : 포인트 내역을 조회한다.*
- *잔고가 부족할 경우, 포인트 사용은 실패하여야 합니다.*
- *동시에 여러 건의 포인트 충전, 이용 요청이 들어올 경우 순차적으로 처리되어야 합니다.*

- `/point` 패키지 (디렉토리) 내에 `PointService` 기본 기능 작성
- `/database` 패키지의 구현체는 수정하지 않고, 이를 활용해 기능을 구현
- 각 기능에 대한 단위 테스트 작성

> 총 4가지 기본 기능 (포인트 조회, 포인트 충전/사용 내역 조회, 충전, 사용) 을 구현합니다.


**STEP01** `기본과제`

- 포인트 충전, 사용에 대한 정책 추가 (잔고 부족, 최대 잔고 등)
- 동시에 여러 요청이 들어오더라도 순서대로 (혹은 한번에 하나의 요청씩만) 제어될 수 있도록 리팩토링
- 동시성 제어에 대한 통합 테스트 작성


<br/>  
<br/>  
<br/>  

## 요구사항 분석


- 포인트 조회  
  - 전제조건) 유저가 존재하지 않는 경우, 초기값 포인트는 0  
  - cf1) 올바르지 않는 userID 인 경우, 예외 발생
- 포인트 충전
  - 포인트 조회
  - 포인트 추가
  - 포인트 내역 추가  
  - cf1) 잔고가 최대 잔고 10000을 초과하는 경우, 포인트 충전 실패
  - cf2) 올바르지 않는 userID 인 경우, 예외 발생
  - cf3) 음수로 충전시 예외발생
  - cf3) 0으로 충전시 예외발생
- 포인트 사용
  - 포인트 조회
  - 포인트 차감
  - 포인트 내역 추가  
  - cf1) 잔고가 부족한 경우, 포인트 사용 실패  
  - cf2) 올바르지 않는 userID 인 경우, 예외 발생
  - cf3) 음수로 사용시 예외발생
  - cf3) 0으로 사용시 예외발생
- 포인트 내역 조회
  - 포인트 충전 성공
  - 포인트 사용 성공


- 동시성
  - 동일한 유저의 포인트 조회, 충전, 사용 요청이 동시에 여러 건 들어올 경우 순차적으로 처리되어야 합니다.
  - 동일한 유저의 충전과 사용 요청이 동시에 들어올 경우 충전 손실이 발생하지 않아야 한다
  - 다른 유저들간은 조회, 충전, 사용 요청은 독립적으로 처리
